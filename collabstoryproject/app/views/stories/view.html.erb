
<% if session[:id] %>
	<h1 class="title"> <%= @story.title %> </h1>
	<h2 class="summary"> <%= @story.summary %> </h2> 

	<div class="break"></div>

	<!-- the container for visualization -->
	<div class="vis" id="viscontainer">

	</div>

	<!-- the read/write interface; should only be able to edit your own nodes; until have users and logins, no editing allowed, only creating new nodes-->
	<div id="rwcontainer">
	<!-- 	<div class="read"></div>-->
		<div id="read">
		</div>
		<div id="write">
			<div id="submit_text_area" contenteditable="true" class="placeholder">
			</div>
			<%= form_tag :html => {:id => 'write-box'} do %>
				<%= hidden_field_tag('submit_sourceID', :value => "some value" ) %>
				<%= hidden_field_tag('submit_storyID', :value => "some value") %>
				<%= hidden_field_tag('submit_userID', :value => "some value") %>
				<span id="error_msg">Empty passages don't add much!</span>
				<button type="button" id="submit_node" class="write_btn">Publish</button>
				<button type="button" id="cancel_btn" class="write_btn">Delete</button>				

			<% end %>		
		</div>
		<div id="add_link">
			<%= form_for(@link, :url => {:controller => "links", :action => "save_link"}, :html => {:id => "new_link_connection"}) do |f| %>
			  	<%=f.hidden_field :source, :value => "some value" %>
			  	<%=f.hidden_field :target, :value => "some value" %> 		
	  			<%=f.hidden_field :story_id, :value => @story.id %>
	  			<%=f.hidden_field :user_id, :value => session[:id] %>
	  			<%=f.submit "Save" %>
	  		<% end %>
		</div>
	</div>
<% end %>

<script>
	display_graph(<%=raw @json_data %>);
	$("#error_msg").hide();
	$("#submit_storyID").val(<%=@story.id %>);
	$("#submit_userID").val(<%=session[:id]%>);
	$('.placeholder').on('input', function(){
    if ($(this).text().length > 0) {
        $(this).removeClass('placeholder');
    } else {
        $(this).addClass('placeholder');
    }
});
</script>